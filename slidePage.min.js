/**
 * LBS slidePage 
 * Date: 2014-11-20 
 **/
!function(){"use strict";window.slidePage=function(a){a=a||{},void 0!==a.el&&(this.box="string"==typeof a.el?document.querySelector(a.el):a.el,this.pages=this.box.children,this.length=this.pages.length,this.length<1||(a.index>this.length-1&&(a.index=0),this.body=document.getElementsByTagName("body")[0],this.nav=null,this.navs=[],this.navShow=!!a.navShow||!1,this.navClass=a.navClass||"slide-nav",this.index=this.oIndex=a.index||0,this.current=a.current||"current",this.locked=!!a.locked||!1,this.auto=!!a.auto||!1,this.auto&&(this.delay=a.delay||5e3),this.effect=a.effect||"translate",this.duration=a.duration||300,this.minScale=a.minScale||.5,this.start=a.start||function(){},this.move=a.move||function(){},this.end=a.end||function(){},this.timer=null,this.animated=!0,this.touch={},this.point="",this.cache={},this.init()))},slidePage.prototype={init:function(){this.navShow&&this.createNav(),this.initSet(),this.bind()},createNav:function(){var a=null,b=0;for(this.nav=document.createElement("ul");b<this.length;b++)a=document.createElement("li"),this.navs.push(a),this.nav.appendChild(a);this.nav.className=this.navClass,this.body.appendChild(this.nav)},initSet:function(){this.height=document.documentElement.clientHeight||document.body.clientHeight,("absolute"!==this.css(this.box,"position")||"relative"!==this.css(this.box,"position"))&&(this.box.style.position="relative"),"hidden"!==this.css(this.box,"overflow")&&(this.box.style.overflow="hidden"),this.box.style.height=this.height+"px";for(var a=0;a<this.length;a++)"none"!==this.css(this.pages[a],"display")&&(this.pages[a].style.display="none"),"absolute"!==this.css(this.pages[a],"position")&&(this.pages[a].style.position="absolute"),this.pages[a].style.height=this.height+"px";this.navShow&&(this.nav.style.marginTop=-this.nav.offsetHeight/2+"px",this.navs[this.index].className=this.current),this.pages[this.index].className+=" "+this.current,this.zIndex=parseInt("auto"===this.css(this.pages[this.index],"zIndex")?1:this.css(this.pages[this.index],zIndex))+10,this.pages[this.index].style.display="block"},bind:function(){var a=this;this.on(this.box,["touchstart","pointerdown","MSPointerDown","mousedown"],function(b){a.touchStart(b),a.auto&&a.stop()}),this.on(this.box,["touchmove","pointermove","MSPointerMove","mousemove"],function(b){a.touchMove(b),a.auto&&a.stop()}),this.on(this.box,["touchend","touchcancel","pointerup","pointercancel","MSPointerUp","MSPointerCancel","mouseup"],function(b){a.touchEnd(b),a.auto&&a.play()}),this.auto&&this.play()},touchStart:function(a){this.point=a.type.toLowerCase().indexOf("down")<0?"touch":"pointer","pointer"===this.point?(this.touch.x=a.pageX,this.touch.y=a.pageY):"touch"===this.point&&(this.touch.x=a.touches[0].pageX,this.touch.y=a.touches[0].pageY),this.touch.disX=0,this.touch.disY=0,this.touch.fixed="",this.start&&this.start()},touchMove:function(a){if(a.stopPropagation(),a.preventDefault(),""!==this.point&&"left"!==this.touch.fixed&&this.animated){if("pointer"===this.point)this.touch.disX=a.pageX-this.touch.x,this.touch.disY=a.pageY-this.touch.y;else if("touch"===this.point){if(a.touches.length>1)return;this.touch.disX=a.touches[0].pageX-this.touch.x,this.touch.disY=a.touches[0].pageY-this.touch.y}if(""===this.touch.fixed&&(Math.abs(this.touch.disY)>Math.abs(this.touch.disX)?this.touch.fixed="up":this.touch.fixed="left"),"up"===this.touch.fixed){if("scale"===this.effect&&(this.scale=((this.height-Math.abs(this.touch.disY))/this.height).toFixed(3),this.scale<this.minScale&&(this.scale=this.minScale)),this.touch.disY>0){if(this.locked&&0===this.oIndex)return;this.dis=-this.height,this.index=this.oIndex-1,this.index<0&&(this.index=this.length-1),"scale"===this.effect&&this.setOrigin(this.oIndex,"center bottom")}else{if(this.locked&&this.oIndex===this.length-1)return;this.dis=this.height,this.index=this.oIndex+1,this.index>this.length-1&&(this.index=0),"scale"===this.effect&&this.setOrigin(this.oIndex,"center top")}void 0!==this.nIndex&&this.nIndex!==this.index&&this.nIndex!==this.oIndex&&(this.pages[this.nIndex].style.display="none",this.pages[this.nIndex].style.zIndex="",this.pages[this.nIndex].style.webkitTransform=this.pages[this.nIndex].style.transform=""),this.nIndex=this.index,this.pages[this.oIndex].style.zIndex=this.zIndex,this.pages[this.index].style.zIndex=this.zIndex+10,this.setTransform(this.index,this.dis),this.pages[this.index].style.display="block",this.setTransform(this.index,this.touch.disY+this.dis),"translate"===this.effect&&this.setTransform(this.oIndex,this.touch.disY),"scale"===this.effect&&this.setScale(this.oIndex,this.scale),this.move&&this.move()}}},touchEnd:function(a){if(this.point="",this.index!==this.oIndex&&"up"===this.touch.fixed){var b=Math.abs(this.touch.disY);this.animated&&b>10||b>this.height/2?this.slide():this.recover(),this.end&&this.end()}},setScale:function(a,b){this.setStyle(this.pages[a],"transform","scale("+b+")")},setOrigin:function(a,b){this.setStyle(this.pages[a],"transform-origin",b)},setTransform:function(a,b){b=b||0,this.setStyle(this.pages[a],"transform","translate3d(0px,"+b+"px,0px)")},setTransition:function(a,b){b=b||0,this.setStyle(this.pages[a],"transition","all "+b+"ms")},setStyle:function(a,b,c){!this.cache[a]&&(this.cache[a]={}),!this.cache[a][b]&&(this.cache[a][b]=this.prefix(b)),a.style[this.cache[a][b]||this.prefix(b)]=c},prefix:function(a){var b=document.createElement("div").style;if(a in b)return a;for(var c=["webkit","Moz","ms","O"],d=0,e=c.length,f="";e>d;d++)if(f=c[d]+"-"+a,f=f.replace(/-\D/g,function(a){return a.charAt(1).toUpperCase()}),f in b)return f},css:function(a,b){return getComputedStyle(a,null)[b]},on:function(a,b,c){for(var d=0,e=b.length;e>d;d++)a.addEventListener(b[d],c,!1)},slide:function(){var a=this;this.animated=!1,this.setTransition(this.index,this.duration),this.setTransition(this.oIndex,this.duration),this.setTransform(this.index,0),"translate"===this.effect&&this.setTransform(this.oIndex,-this.dis),"scale"===this.effect&&this.setScale(this.oIndex,this.minScale),setTimeout(function(){a.index!==a.oIndex&&a.update(),a.animated=!0},this.duration)},recover:function(){var a=this;this.setTransition(this.index,100),this.setTransition(this.oIndex,100),this.setTransform(this.index,this.dis),"translate"===this.effect&&this.setTransform(this.oIndex,0),"scale"===this.effect&&this.setScale(this.oIndex,1),setTimeout(function(){a.clear(),a.pages[a.index].style.display="none",a.index=a.oIndex},100)},update:function(){this.navShow&&(this.navs[this.index].className=this.current,this.navs[this.oIndex].className=""),this.pages[this.oIndex].style.display="none",this.pages[this.index].className+=" "+this.current,this.pages[this.oIndex].className=this.pages[this.oIndex].className.replace(this.current,"").trim(),this.clear(),this.oIndex=this.index},empty:function(a){this.setStyle(this.pages[a],"transform",""),this.setStyle(this.pages[a],"transition",""),this.pages[a].style.zIndex=""},clear:function(){this.empty(this.index),this.empty(this.oIndex),"scale"===this.effect&&this.setOrigin(this.oIndex,"")},animate:function(){var a=this;this.setTransform(this.index,this.dis),this.pages[this.index].style.display="block",this.pages[this.oIndex].style.zIndex=this.zIndex,this.pages[this.index].style.zIndex=this.zIndex+10,this.setTransition(this.index,0),this.setTransition(this.oIndex,0),setTimeout(function(){a.slide()},50)},up:function(){this.dis=this.height,this.index++,this.index>this.length-1&&(this.index=0),"scale"===this.effect&&this.setOrigin(this.oIndex,"center top"),this.animate()},down:function(){this.dis=-this.height,this.index--,this.index<0&&(this.index=this.length-1),"scale"===this.effect&&this.setOrigin(this.oIndex,"center bottom"),this.animate()},play:function(){var a=this;this.locked||(this.timer=setInterval(function(){a.up()},this.delay))},stop:function(){this.timer&&clearInterval(this.timer),this.timer=null}}}();